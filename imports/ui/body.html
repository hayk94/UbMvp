<body>
  <!-- <ul>
    {{#each tasks}}
      {{> task}}
    {{/each}}
  </ul> -->


    <!-- {{>mainLayout}} -->

    <!-- <h2>Connections</h2> -->
    <!-- {{#each conns}}
      {{> conn}}
    {{/each}} -->
    <!-- <pre>
      {{conns}}
    </pre> -->

</body>

<template name="mainLayout">
  <header>
    <nav class="navbar">
      <a class="nav-item" href="/ips">ips</a> <br/>
      <a class="nav-item" href="/ui">UI</a>
    </nav>
  </header>
  <main>
    {{>Template.dynamic template=content}}
  </main>
</template>

<template name="ui">
  <a href="/">Back</a>
  <h1>UI</h1>
  {{#each ips}}
    <div>
      <p>
        <h2><strong>IP: </strong><span>{{ipAdr}}</span></h2>
      </p>
    </div>
    {{#each connections}}
      <div>
        <h4>Connection</h4>
        <p>
          Started: {{connectedAt}}
        </p>
        <p>
          {{#if disconnectedAt}}
            Stoped: {{disconnectedAt}}
            {{else}}
            <span>ONLINE</span>
          {{/if}}
        </p>
        <div>
          <h4>User Visited Pages</h4>
        {{#each visits}}
            <div>
              <p>
                <strong>Visited Link :</strong> {{visitedThis}}
              </p>
              <p>
                <strong>Visited At: </strong>{{visitedAt}}
              </p>
            </div>
        {{/each}}
        <h4>User Clicked On These</h4>
      {{#each clicks}}
          <div>
            <p>
              <strong>Clicked This :</strong> {{clickedThis}}
            </p>
            <p>
              <strong>Clicked At: </strong>{{clickedAt}}
            </p>
          </div>
      {{/each}}
    </div>
      </div>
    {{/each}}
    <!-- connections -->
  {{/each}}
  <!-- ips -->
</template>

<template name="home">
  Welcome!
</template>

<template name="ips">
  <a href="/">back</a>
  <h1>IPS</h1>
  <!-- {{#each ips}}
    {{> ip}}
  {{/each}} -->
  <pre>
    {{ips}}
  </pre>

</template>

<template name="blogHome">
  <p>
    This is the home page of our blog
  </p>
  <p>
    <a href="/hello-world">See Hello World Post</a>
  </p>
</template>

<template name="blogPost">
  <p>
    <a href="/">Back</a> <br>
    This is a sing blog post
  </p>
</template>

<template name="ip">
  <ul>
    <li><strong>ID:</strong> {{_id}}</li>
    <li><strong>IP:</strong> {{ipAdr}}</li>
    <li>
      <p>
        <strong>Connections from this Ip</strong>
      </p>
      <button class="showHide">Toggle</button>
      <ul class="conns">
      {{#each item in connections}}
        {{#each keyval item}}
          <li><span>{{key}} : {{value}}</span></li>
        {{/each}}
      {{/each}}
    </ul>
  </li>
    <li><strong>Ip first registered:</strong> {{createdAt}}</li>
  </ul>
</template>

<template name="task">
  <li>{{text}}</li>
</template>

<template name="conn">
  <li><ul>
    <li>{{connID}}</li>
    <li>{{ipAdr}}</li>
    <li>
      <ul>
        <!-- {{#each item in httpHeads}}
          {{#each keyval item}}
            <li><span>{{key}} : {{val}}</span></li>
          {{/each}}
        {{/each}} -->
        <li>{{httpHeads.host}}</li>
        <li>{{httpHeads.userAgent}}</li>
        <li>{{httpHeads.realIP}}</li>
      </ul>
    </li>
    <li>{{createdAt}}</li>
  </ul></li>
</template>
